function ready(e){document.readyState!='loading'?e():document.addEventListener('DOMContentLoaded',e)}ready(doSearch),summaryInclude=60;var fuseOptions={shouldSort:!0,includeMatches:!0,threshold:.3,tokenize:!0,location:0,distance:100,maxPatternLength:32,minMatchCharLength:1,keys:[{name:"title",weight:.8},{name:"content",weight:.5},{name:"tags",weight:.3},{name:"categories",weight:.3}]},searchQuery;function param(e){return decodeURIComponent((location.search.split(e+'=')[1]||'').split('&')[0]).replace(/\+/g,' ')}searchQuery=param("s");function doSearch(){if(searchQuery)document.getElementById("search-query").value=searchQuery,executeSearch(searchQuery);else{var e=document.createElement("P");e.innerText="Please enter a word or phrase above",document.getElementById("search-results").appendChild(e)}}function getJSON(t,n){var e=new XMLHttpRequest;e.open('GET',t,!0),e.onload=function(){if(e.status>=200&&e.status<400){var s=JSON.parse(e.responseText);n(s)}else console.log("Target reached on "+t+" with error "+e.status)},e.onerror=function(){console.log("Connection error "+e.status)},e.send()}function executeSearch(e){getJSON("/index.json",function(s){var n,o=s,i=new Fuse(o,fuseOptions),t=i.search(e);console.log({matches:t}),t.length>0?populateResults(t):(n=document.createElement("P"),n.innerText="No matches found",document.getElementById("search-results").appendChild(n))})}function populateResults(e){e.forEach(function(e,o){var i,a,t=e.item.contents,n="",s=[],r=[];fuseOptions.tokenize?s.push(searchQuery):e.matches.forEach(function(e){e.key=="tags"||e.key=="categories"?s.push(e.value):e.key=="content"&&(start=e.indices[0][0]-summaryInclude>0?e.indices[0][0]-summaryInclude:0,end=e.indices[0][1]+summaryInclude<t.length?e.indices[0][1]+summaryInclude:t.length,n+=t.substring(start,end),s.push(e.value.substring(e.indices[0][0],e.indices[0][1]-e.indices[0][0]+1)))}),n.length<1&&(n+=t.substring(0,summaryInclude*2)),i=document.getElementById("search-result-template").innerHTML,a=render(i,{key:o,title:e.item.title,link:e.item.permalink,tags:e.item.tags,categories:e.item.categories,snippet:n}),document.getElementById("search-results").appendChild(htmlToElement(a)),s.forEach(function(e){new Mark(document.getElementById("summary-"+o)).mark(e)})})}function render(e,s){i=/\$\{\s*isset ([a-zA-Z]*) \s*\}(.*)\$\{\s*end\s*}/g,t=e;for(var t,n,o,i,a,r;(n=i.exec(e))!==null;)s[n[1]]?t=t.replace(n[0],n[2]):t=t.replace(n[0],'');e=t;for(o in s)a='\\$\\{\\s*'+o+'\\s*\\}',r=new RegExp(a,'g'),e=e.replace(r,s[o]);return e}function htmlToElement(e){var t=document.createElement('template');return e=e.trim(),t.innerHTML=e,t.content.firstChild}